

<#macro getTextAreaContent responseContent has_error entry>
  <#assign field_width=getFieldValueByCode( entry, "width")>
  <#assign field_height=getFieldValueByCode( entry, "height")>
  <#assign idName = buildEntryName( entry, entry_iteration_number )>
  <#assign field_richtext=getFieldValueByCode( entry, "richtext")>
	<#assign richtext = false />
	<#if field_richtext == 'true'>
		<#assign richtext = true />
	</#if>
  <#if has_error>
    <textarea name="${idName}" id="${idName}" cols="${field_width?number}" rows="${field_height?number}" class="alert alert-danger<#if richtext> richtext</#if> form-control">${responseContent}</textarea>
  <#else>
    <textarea name="${idName}" id="${idName}" cols="${field_width?number}" rows="${field_height?number}" class="${entry.CSSClass!}<#if richtext> richtext</#if> form-control">${responseContent}</textarea>
  </#if>
</#macro>

<div class="form-group">
  <#assign idName = buildEntryName( entry, entry_iteration_number )>
  <label class="control-label col-xs-12 col-sm-12 col-md-3 col-lg-3" for="${idName}">${entry.title}<#if entry.mandatory> *</#if></label>
  <@columns sm=12 md=6 lg=6>
    <#assign field=getFieldByCode( entry, "text_config")>
      <#if list_responses?? && list_responses?has_content>
        <#list list_responses as response>
          <#if response.entry.idEntry == entry.idEntry && response.toStringValueResponse??>
            <#if response.entry.error??>
              <@getTextAreaContent responseContent=response.toStringValueResponse has_error=true entry=entry />
            <#else>
              <@getTextAreaContent responseContent=response.toStringValueResponse has_error=false entry=entry />
            </#if>
          </#if>
        </#list>
      <#else>
        <#if field.value?exists>
          <@getTextAreaContent responseContent=field.value has_error=false entry=entry />
        <#else>
          <@getTextAreaContent responseContent="" has_error=false entry=entry />
        </#if>
      </#if>
    <#if entry.helpMessage?exists&&entry.helpMessage!=''>
      <span class="help-block">${entry.helpMessage}</span>
    </#if>
  </@columns>
</div>

<#if list_responses??>
  <#list list_responses as response>
    <#if response.entry.idEntry == entry.idEntry && response.entry.error?? && response.entry.error.isDisplayableError>
      <div class="alert alert-danger">
        <#assign error = response.entry.error>
        <#if error.mandatoryError>#i18n{forms.message.mandatory.entry}<#else>${error.errorMessage}</#if>
      </div>
    </#if>
  </#list>
</#if>

<#if entry.fieldInLine>
  <#include "/util/editor/editor.html" />
  <@initEditor />
</#if>
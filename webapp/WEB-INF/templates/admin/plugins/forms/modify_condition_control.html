<#include "/admin/plugins/forms/commons.html" />
<@box>
    <@boxHeader title='${modify_condition_title}' boxTools=true>
        <#if control.id gt 0>
            <@aButton href='jsp/admin/plugins/forms/ManageControls.jsp?view=confirmRemoveControl&id_control=${control.id}' title='#i18n{forms.manage_controls.action.removeControl}' class='pull-right' buttonIcon='trash' color='btn-link text-danger' />
        </#if>
    </@boxHeader>
    <@boxBody>
        <@tform class="form-horizontal" method="post" id="modify_control" name="modify_control" action="jsp/admin/plugins/forms/ManageControls.jsp">
        <@messages errors=errors />
        <@formGroup labelKey='#i18n{forms.modify_control.labelStep}' helpKey='#i18n{forms.modify_control.labelStep.help}' mandatory=true>
            <@inputGroup>
                <@select name='id_step' items=availableSteps default_value='${id_step!}' />
                <@inputGroupItem>
                    <@button type='submit' name="view_modifyControl" value="validateStep" showTitle=false buttonIcon='check'/>
                </@inputGroupItem>
            </@inputGroup>
        </@formGroup>
        <@formGroup labelKey='#i18n{forms.modify_control.labelQuestion}' helpKey='#i18n{forms.modify_control.labelQuestion.help}' mandatory=true>
            <@inputGroup>
                <@select name='id_question' items=listQuestion default_value='${control.idQuestion!}' />
                <@inputGroupItem>
                    <@button type='submit' name="view_modifyControl" value="validateQuestion" showTitle=false buttonIcon='check'/>
                </@inputGroupItem>
            </@inputGroup>
        </@formGroup>
        <@formGroup labelKey='#i18n{forms.modify_control.labelValidator}' helpKey='#i18n{forms.modify_control.labelValidator.help}' mandatory=true>
            <@inputGroup>
                <@select name='validatorName' items=availableValidators default_value='${control.validatorName!}' />
                <@inputGroupItem>
                    <@button type='submit' name="view_modifyControl" value="validateValidator" showTitle=false buttonIcon='check'/>
                </@inputGroupItem>
            </@inputGroup>
        </@formGroup>
        
        ${control_template}

        <@formsButton okAction='modifyControl' viewAction='' />
        </@tform>
    </@boxBody>
</@box>

<script>
$( function(){
    var formAction = $('#modify_control'), btnAction = $('#action_modifyControl');
    $('body').css( 'overflow', 'hidden' );
    $('.content-header').hide();
    $('#admin-wrapper').css( 'margin', '0' ).css( 'overflow', 'hidden' );
    $('header').remove();
    $('#footer').remove();

    btnAction.click( function(e){ 
        formAction.submit( function(){
            e.preventDefault();
            formAction.attr('target','_top');
            _this.unbind('submit').submit();
        });
    });
});
</script>